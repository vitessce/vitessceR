---
title: "Usage with Seurat: Basic Example"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Usage with Seurat: Basic Example}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

The following is a full example of usage of the widget with a [Seurat](https://satijalab.org/seurat/) object.


First, install the R dependencies:

```r
install.packages("seurat")
install.packages("devtools")
devtools::install_github("mojaveazure/seurat-disk")
devtools::install_github("vitessce/vitessceAnalysisR")
```


Download the dataset, load and preprocess the Seurat object, and configure the Vitessce widget:

```r
library(vitessceR)
library(vitessceAnalysisR)
library(Seurat)

adata_path <- file.path("data", "seurat", "pbmcsca.h5ad.zarr")

seu <- get_seurat_v5_obj()
sce <- seurat_to_sce(seu)
sce_to_anndata_zarr(sce, adata_path)

# Create Vitessce view config
vc <- VitessceConfig$new(schema_version = "1.0.16", name = "My config")
dataset <- vc$add_dataset("My dataset")$add_object(AnnDataWrapper$new(
  adata_path=adata_path,
  obs_set_paths = c("obs/CellType"),
  obs_feature_matrix_path = "X"
))
status <- vc$add_view(dataset, Component$STATUS)
desc <- vc$add_view(dataset, Component$DESCRIPTION)
desc <- desc$set_props(description = "Visualization of a Seurat object containing the PBMC 3K dataset.")
genes <- vc$add_view(dataset, Component$FEATURE_LIST)
heatmap <- vc$add_view(dataset, Component$HEATMAP)
vc$link_views(
  list(heatmap),
  list(CoordinationType$FEATURE_VALUE_COLORMAP_RANGE),
  list(c(0.0, 0.05))
)
vc$layout(hconcat(
  heatmap,
  vconcat(genes, vconcat(desc, status))
))

# Render the Vitessce widget
vc$widget(theme = "light")
```



